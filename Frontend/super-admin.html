<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CondoSys - Super Administrador</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      
      :root {
        --primary-color: #9c27b0;
        --secondary-color: #ff5722;
        --background-color: #f3e5f5;
        --text-color: #4a148c;
        --card-bg: rgba(255, 255, 255, 0.95);
        --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        --border-radius: 15px;
        --transition: all 0.3s ease;
        
        /* Design System Moderno */
        --primary-gradient: linear-gradient(135deg, #9c27b0 0%, #ff5722 100%);
        --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        --warning-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        --glass-bg: rgba(255, 255, 255, 0.1);
        --glass-border: rgba(255, 255, 255, 0.2);
        --shadow-elevated: 0 20px 40px rgba(0, 0, 0, 0.15);
        --shadow-soft: 0 8px 25px rgba(0, 0, 0, 0.1);
        --border-radius-modern: 20px;
        --border-radius-soft: 12px;
      }

      body {
        font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        min-height: 100vh;
        color: var(--text-color);
        margin: 0;
        padding: 0;
        position: relative;
        overflow-x: hidden;
      }

      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="10" cy="60" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="90" cy="40" r="0.5" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        opacity: 0.3;
        pointer-events: none;
        z-index: 0;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        position: relative;
        z-index: 1;
      }
      
      header {
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--border-radius);
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: var(--shadow);
        border: 1px solid rgba(255, 255, 255, 0.2);
        text-align: center;
      }

      .logo {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        margin-bottom: 20px;
      }

      .logo-icon {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        box-shadow: 0 8px 25px rgba(156, 39, 176, 0.3);
      }

      .logo-icon::before {
        content: 'üè¢';
        font-size: 30px;
        color: white;
      }

      .logo-text h1 {
        font-size: 2.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 5px;
      }

      .logo-text .subtitle {
        font-size: 1rem;
        color: #666;
        font-weight: 500;
      }

      .card {
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--border-radius);
        padding: 30px;
        margin-bottom: 25px;
        box-shadow: var(--shadow);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: var(--transition);
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--text-color);
      }

      input, button {
        width: 100%;
        padding: 15px 20px;
        border: 2px solid rgba(156, 39, 176, 0.2);
        border-radius: 12px;
        font-size: 1rem;
        transition: var(--transition);
        background: rgba(255, 255, 255, 0.9);
      }

      input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
      }

      button {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
        border: none;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        transition: var(--transition);
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(156, 39, 176, 0.4);
      }

      .alert {
        padding: 20px 25px;
        border-radius: 15px;
        margin-bottom: 25px;
        border-left: 5px solid;
        position: relative;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        animation: slideInDown 0.5s ease-out;
      }

      .alert-success {
        background: linear-gradient(135deg, #d4edda, #c3e6cb);
        border-color: #28a745;
        color: #155724;
      }
      
      .alert-error {
        background: linear-gradient(135deg, #f8d7da, #f5c6cb);
        border-color: #dc3545;
        color: #721c24;
      }

      @keyframes slideInDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .loading {
        display: inline-block;
        width: 24px;
        height: 24px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        animation: spin 1s ease-in-out infinite;
        margin-right: 10px;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      .hidden {
        display: none !important;
      }

      .fade-in {
        animation: fadeIn 0.6s ease-out;
      }
      
      @keyframes fadeIn {
        from { 
          opacity: 0; 
          transform: translateY(30px) scale(0.95); 
        }
        to { 
          opacity: 1; 
          transform: translateY(0) scale(1); 
        }
      }

      /* Navega√ß√£o */
      .banner {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--border-radius-modern);
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: var(--shadow-soft);
        border: 1px solid var(--glass-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
      }

      nav {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
      }

      nav a {
        color: var(--text-color);
        text-decoration: none;
        padding: 12px 20px;
        border-radius: var(--border-radius-soft);
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      nav a:hover {
        background: var(--primary-gradient);
        color: white;
        transform: translateY(-2px);
        box-shadow: var(--shadow-soft);
      }

      /* Views */
      .view {
        display: block;
      }

      .view.hidden {
        display: none;
      }

      /* Stats Grid */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
        margin: 30px 0;
      }

      .stat-card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--border-radius-modern);
        padding: 30px;
        text-align: center;
        box-shadow: var(--shadow-soft);
        border: 1px solid var(--glass-border);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--primary-gradient);
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .stat-card:hover::before {
        transform: scaleX(1);
      }

      .stat-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-elevated);
      }

      .stat-card i {
        font-size: 3rem;
        margin-bottom: 20px;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        transition: all 0.3s ease;
      }

      .stat-card:hover i {
        transform: scale(1.1) rotate(5deg);
      }

      .stat-card h3 {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 10px;
        color: var(--text-color);
      }

      .stat-card p {
        color: #666;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.9rem;
      }

      /* Charts Grid */
      .charts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 25px;
        margin-top: 30px;
      }

      .chart-container {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--border-radius-modern);
        padding: 25px;
        box-shadow: var(--shadow-soft);
        border: 1px solid var(--glass-border);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      .chart-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--primary-gradient);
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .chart-container:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-elevated);
      }

      .chart-container:hover::before {
        opacity: 1;
      }

      .chart-container h4 {
        margin-bottom: 20px;
        color: var(--text-color);
        font-size: 1.1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .chart-container h4 i {
        color: var(--primary-color);
      }

      .chart-container canvas {
        max-height: 300px;
        width: 100% !important;
        height: auto !important;
      }

      /* Tabelas */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 25px;
        background: white;
        border-radius: var(--border-radius-modern);
        overflow: hidden;
        box-shadow: var(--shadow-soft);
        border: 1px solid rgba(0, 0, 0, 0.05);
      }

      th, td {
        padding: 18px 20px;
        text-align: left;
        border-bottom: 1px solid #f0f0f0;
        font-size: 0.95rem;
      }

      th {
        background: var(--primary-gradient);
        color: white;
        font-weight: 700;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 1px;
      }

      tr:hover {
        background: rgba(156, 39, 176, 0.05);
      }

      /* Bot√µes */
      .btn-primary {
        background: var(--primary-gradient);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: var(--border-radius-soft);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-soft);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #6c757d, #495057);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: var(--border-radius-soft);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .btn-secondary:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-soft);
      }

      /* Row Layout */
      .row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      /* Status Badges */
      .status-badge {
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: inline-block;
      }

      .status-confirmed {
        background: var(--success-gradient);
        color: white;
      }

      .status-cancelled {
        background: var(--secondary-gradient);
        color: white;
      }

      /* Permiss√µes */
      .permissions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
        margin: 25px 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: var(--border-radius-soft);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Controle de Telas */
      .screen-permissions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 25px 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: var(--border-radius-soft);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .screen-category {
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: var(--border-radius-soft);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .screen-category h5 {
        color: var(--text-color);
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
        border-bottom: 2px solid var(--primary-color);
        padding-bottom: 8px;
      }

      .screen-category h5 i {
        color: var(--primary-color);
      }

      /* Templates de Fun√ß√£o */
      .role-templates {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin: 25px 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: var(--border-radius-soft);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .btn-template {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: var(--border-radius-soft);
        padding: 15px 20px;
        color: var(--text-color);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 180px;
        justify-content: center;
      }

      .btn-template:hover {
        background: var(--primary-gradient);
        color: white;
        transform: translateY(-3px);
        box-shadow: var(--shadow-soft);
      }

      .btn-template i {
        font-size: 1.1rem;
      }

      .permission-category {
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: var(--border-radius-soft);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .permission-category h5 {
        color: var(--text-color);
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
        border-bottom: 2px solid var(--primary-color);
        padding-bottom: 8px;
      }

      .permission-category h5 i {
        color: var(--primary-color);
      }

      .permission-item {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 12px;
        padding: 8px 12px;
        border-radius: 8px;
        transition: all 0.3s ease;
        cursor: pointer;
        user-select: none;
      }

      .permission-item:hover {
        background: rgba(156, 39, 176, 0.1);
        transform: translateX(5px);
      }

      .permission-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: var(--primary-color);
        cursor: pointer;
      }

      .permission-item span {
        color: var(--text-color);
        font-weight: 500;
        font-size: 0.9rem;
      }

      .permission-item input[type="checkbox"]:checked + span {
        color: var(--primary-color);
        font-weight: 600;
      }

      /* Bot√µes pequenos */
      .btn-sm {
        padding: 6px 12px;
        font-size: 0.8rem;
        border-radius: 6px;
      }

      /* Responsividade */
      @media (max-width: 768px) {
        .banner {
          flex-direction: column;
          text-align: center;
        }

        nav {
          justify-content: center;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .charts-grid {
          grid-template-columns: 1fr;
        }

        .row {
          grid-template-columns: 1fr;
        }

        .permissions-grid {
          grid-template-columns: 1fr;
        }

        .screen-permissions-grid {
          grid-template-columns: 1fr;
        }

        .role-templates {
          flex-direction: column;
        }

        .btn-template {
          min-width: auto;
          width: 100%;
        }

        table {
          font-size: 0.8rem;
        }

        th, td {
          padding: 10px 8px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="logo">
          <div class="logo-icon"></div>
          <div class="logo-text">
            <h1>CondoSys</h1>
            <span class="subtitle">Super Administrador</span>
          </div>
        </div>
      </header>

      <div id="login" class="card fade-in">
        <h3><i class="fas fa-crown"></i> Login Super Administrador</h3>
        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" placeholder="superadmin@condosys.com" type="email" />
        </div>
        <div class="form-group">
          <label for="password">Senha</label>
          <input id="password" placeholder="Sua senha" type="password" />
        </div>
        <button id="btn-login">
          <i class="fas fa-sign-in-alt"></i> Entrar
        </button>
        <div id="login-msg"></div>
      </div>

      <div id="dashboard" class="hidden">
        <!-- Header com navega√ß√£o -->
        <header class="banner">
          <div class="logo">
            <div class="logo-icon"></div>
            <div class="logo-text">
              <h1>CondoSys</h1>
              <span class="subtitle">Super Administrador</span>
            </div>
          </div>
          <nav id="main-nav">
            <a href="#" data-view="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
            <a href="#" data-view="tenants"><i class="fas fa-building"></i> Condom√≠nios</a>
            <a href="#" data-view="users"><i class="fas fa-users"></i> Usu√°rios</a>
            <a href="#" data-view="reports"><i class="fas fa-chart-bar"></i> Relat√≥rios</a>
            <a href="#" id="logout"><i class="fas fa-sign-out-alt"></i> Sair</a>
          </nav>
        </header>

        <!-- Dashboard Principal -->
        <div id="view-dashboard" class="view">
          <div class="card">
            <h3><i class="fas fa-tachometer-alt"></i> Dashboard Super Admin</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <i class="fas fa-building"></i>
                <h3 id="total-tenants">0</h3>
                <p>Total de Condom√≠nios</p>
              </div>
              <div class="stat-card">
                <i class="fas fa-check-circle"></i>
                <h3 id="active-tenants">0</h3>
                <p>Condom√≠nios Ativos</p>
              </div>
              <div class="stat-card">
                <i class="fas fa-users"></i>
                <h3 id="total-users">0</h3>
                <p>Total de Usu√°rios</p>
              </div>
              <div class="stat-card">
                <i class="fas fa-calendar-check"></i>
                <h3 id="total-reservations">0</h3>
                <p>Total de Reservas</p>
              </div>
            </div>
            
            <!-- Gr√°ficos do Dashboard -->
            <div class="charts-grid">
              <div class="chart-container">
                <h4><i class="fas fa-chart-line"></i> Condom√≠nios por M√™s</h4>
                <canvas id="tenantsChart"></canvas>
              </div>
              <div class="chart-container">
                <h4><i class="fas fa-chart-pie"></i> Status dos Condom√≠nios</h4>
                <canvas id="statusChart"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Gest√£o de Condom√≠nios -->
        <div id="view-tenants" class="view hidden">
          <div class="card">
            <h3><i class="fas fa-building"></i> Gerenciar Condom√≠nios</h3>
            <div class="row">
              <div class="form-group">
                <label for="search-tenant">Buscar Condom√≠nio</label>
                <input id="search-tenant" placeholder="Digite o nome do condom√≠nio..." />
              </div>
              <div class="form-group">
                <label>&nbsp;</label>
                <button id="refresh-tenants" class="btn-secondary">
                  <i class="fas fa-sync-alt"></i> Atualizar
                </button>
              </div>
            </div>
            <table id="tbl-tenants">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nome</th>
                  <th>CNPJ</th>
                  <th>Email</th>
                  <th>Status</th>
                  <th>Data Cria√ß√£o</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          
          <div class="card">
            <h3><i class="fas fa-plus"></i> Cadastrar Novo Condom√≠nio</h3>
            <form id="tenant-form">
              <div class="row">
                <div class="form-group">
                  <label for="new-tenant-name">Nome do Condom√≠nio</label>
                  <input id="new-tenant-name" placeholder="Ex: Condom√≠nio Novo" required />
                </div>
                <div class="form-group">
                  <label for="new-tenant-cnpj">CNPJ</label>
                  <input id="new-tenant-cnpj" placeholder="00.000.000/0000-00" required />
                </div>
              </div>
              <div class="row">
                <div class="form-group">
                  <label for="new-tenant-address">Endere√ßo</label>
                  <input id="new-tenant-address" placeholder="Rua, n√∫mero, bairro, cidade" required />
                </div>
                <div class="form-group">
                  <label for="new-tenant-phone">Telefone</label>
                  <input id="new-tenant-phone" placeholder="(11) 99999-9999" required />
                </div>
              </div>
              <div class="form-group">
                <label for="new-tenant-email">Email do Condom√≠nio</label>
                <input id="new-tenant-email" placeholder="contato@condominio.com" type="email" required />
              </div>
              <h4>Configura√ß√µes de Tema</h4>
              <div class="row">
                <div class="form-group">
                  <label for="new-theme-primary">Cor Prim√°ria</label>
                  <input id="new-theme-primary" type="color" value="#9c27b0" />
                </div>
                <div class="form-group">
                  <label for="new-theme-secondary">Cor Secund√°ria</label>
                  <input id="new-theme-secondary" type="color" value="#ff5722" />
                </div>
              </div>
              <h4>Usu√°rio Administrador</h4>
              <div class="row">
                <div class="form-group">
                  <label for="new-admin-name">Nome do Admin</label>
                  <input id="new-admin-name" placeholder="Nome completo" required />
                </div>
                <div class="form-group">
                  <label for="new-admin-email">Email do Admin</label>
                  <input id="new-admin-email" placeholder="admin@condominio.com" type="email" required />
                </div>
              </div>
              <div class="form-group">
                <label for="new-admin-password">Senha do Admin</label>
                <input id="new-admin-password" placeholder="Senha segura" type="password" required />
              </div>
              <button type="submit" class="btn-primary">
                <i class="fas fa-plus"></i> Cadastrar Condom√≠nio
              </button>
            </form>
          </div>
        </div>

        <!-- Gest√£o de Usu√°rios -->
        <div id="view-users" class="view hidden">
          <div class="card">
            <h3><i class="fas fa-users"></i> Gerenciar Usu√°rios (Global)</h3>
            <div class="row">
              <div class="form-group">
                <label for="search-user">Buscar Usu√°rio</label>
                <input id="search-user" placeholder="Digite o nome ou email..." />
              </div>
              <div class="form-group">
                <label for="filter-tenant">Filtrar por Condom√≠nio</label>
                <select id="filter-tenant">
                  <option value="">Todos os condom√≠nios</option>
                </select>
              </div>
            </div>
            <table id="tbl-users">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nome</th>
                  <th>Email</th>
                  <th>Condom√≠nio</th>
                  <th>Fun√ß√£o</th>
                  <th>Status</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          
          <!-- Cria√ß√£o de Usu√°rios -->
          <div class="card">
            <h3><i class="fas fa-user-plus"></i> Criar Novo Usu√°rio</h3>
            <form id="user-form">
              <div class="row">
                <div class="form-group">
                  <label for="new-user-name">Nome Completo</label>
                  <input id="new-user-name" placeholder="Nome completo do usu√°rio" required />
                </div>
                <div class="form-group">
                  <label for="new-user-email">Email</label>
                  <input id="new-user-email" placeholder="usuario@email.com" type="email" required />
                </div>
              </div>
              <div class="row">
                <div class="form-group">
                  <label for="new-user-password">Senha</label>
                  <input id="new-user-password" placeholder="Senha segura" type="password" required />
                </div>
                <div class="form-group">
                  <label for="new-user-tenant">Condom√≠nio</label>
                  <select id="new-user-tenant" required>
                    <option value="">Selecione um condom√≠nio</option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="form-group">
                  <label for="new-user-role">Fun√ß√£o</label>
                  <select id="new-user-role" required>
                    <option value="">Selecione uma fun√ß√£o</option>
                    <option value="admin">Administrador</option>
                    <option value="morador">Morador</option>
                    <option value="sindico">S√≠ndico</option>
                    <option value="porteiro">Porteiro</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="new-user-status">Status</label>
                  <select id="new-user-status">
                    <option value="true">Ativo</option>
                    <option value="false">Inativo</option>
                  </select>
                </div>
              </div>
              
              <!-- Controle de Acesso por Telas -->
              <h4><i class="fas fa-desktop"></i> Controle de Acesso por Telas</h4>
              <div class="screen-permissions-grid">
                <div class="screen-category">
                  <h5><i class="fas fa-tachometer-alt"></i> Dashboard</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="dashboard" checked>
                    <span>Dashboard Principal</span>
                  </label>
                </div>
                
                <div class="screen-category">
                  <h5><i class="fas fa-users"></i> Gest√£o de Pessoas</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="users">
                    <span>Gerenciar Usu√°rios</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="family">
                    <span>Membros da Fam√≠lia</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="visitors">
                    <span>Visitantes</span>
                  </label>
                </div>
                
                <div class="screen-category">
                  <h5><i class="fas fa-building"></i> Gest√£o de Propriedades</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="units">
                    <span>Unidades</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="maintenance">
                    <span>Manuten√ß√£o</span>
                  </label>
                </div>
                
                <div class="screen-category">
                  <h5><i class="fas fa-calendar-check"></i> Reservas e Eventos</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="reservations">
                    <span>Reservas de √Åreas</span>
                  </label>
                </div>
                
                <div class="screen-category">
                  <h5><i class="fas fa-chart-bar"></i> Relat√≥rios e An√°lises</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="screen_permissions" value="reports">
                    <span>Relat√≥rios</span>
                  </label>
                </div>
              </div>

              <!-- Templates de Fun√ß√£o -->
              <h4><i class="fas fa-magic"></i> Templates de Fun√ß√£o</h4>
              <div class="role-templates">
                <button type="button" class="btn-template" onclick="applyRoleTemplate('admin')">
                  <i class="fas fa-crown"></i> Administrador Completo
                </button>
                <button type="button" class="btn-template" onclick="applyRoleTemplate('sindico')">
                  <i class="fas fa-user-tie"></i> S√≠ndico
                </button>
                <button type="button" class="btn-template" onclick="applyRoleTemplate('morador')">
                  <i class="fas fa-home"></i> Morador
                </button>
                <button type="button" class="btn-template" onclick="applyRoleTemplate('porteiro')">
                  <i class="fas fa-shield-alt"></i> Porteiro
                </button>
                <button type="button" class="btn-template" onclick="applyRoleTemplate('custom')">
                  <i class="fas fa-cog"></i> Personalizado
                </button>
              </div>

              <!-- Permiss√µes Espec√≠ficas -->
              <h4><i class="fas fa-key"></i> Permiss√µes Espec√≠ficas</h4>
              <div class="permissions-grid">
                <div class="permission-category">
                  <h5><i class="fas fa-users"></i> Gest√£o de Usu√°rios</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="manage_users">
                    <span>Gerenciar usu√°rios</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="create_users">
                    <span>Criar usu√°rios</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="edit_users">
                    <span>Editar usu√°rios</span>
                  </label>
                </div>
                
                <div class="permission-category">
                  <h5><i class="fas fa-building"></i> Gest√£o de Unidades</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="manage_units">
                    <span>Gerenciar unidades</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="create_units">
                    <span>Criar unidades</span>
                  </label>
                </div>
                
                <div class="permission-category">
                  <h5><i class="fas fa-calendar-check"></i> Reservas</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="manage_reservations">
                    <span>Gerenciar reservas</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="create_reservations">
                    <span>Criar reservas</span>
                  </label>
                </div>
                
                <div class="permission-category">
                  <h5><i class="fas fa-user-friends"></i> Visitantes</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="manage_visitors">
                    <span>Gerenciar visitantes</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="register_visitors">
                    <span>Registrar visitantes</span>
                  </label>
                </div>
                
                <div class="permission-category">
                  <h5><i class="fas fa-tools"></i> Manuten√ß√£o</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="manage_maintenance">
                    <span>Gerenciar manuten√ß√£o</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="create_maintenance">
                    <span>Criar ordens de manuten√ß√£o</span>
                  </label>
                </div>
                
                <div class="permission-category">
                  <h5><i class="fas fa-chart-bar"></i> Relat√≥rios</h5>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="view_reports">
                    <span>Visualizar relat√≥rios</span>
                  </label>
                  <label class="permission-item">
                    <input type="checkbox" name="permissions" value="export_reports">
                    <span>Exportar relat√≥rios</span>
                  </label>
                </div>
              </div>
              
              <div class="row">
                <div class="form-group">
                  <label for="new-user-phone">Telefone (opcional)</label>
                  <input id="new-user-phone" placeholder="(11) 99999-9999" />
                </div>
                <div class="form-group">
                  <label for="new-user-document">CPF (opcional)</label>
                  <input id="new-user-document" placeholder="000.000.000-00" />
                </div>
              </div>
              
              <button type="submit" class="btn-primary">
                <i class="fas fa-user-plus"></i> Criar Usu√°rio
              </button>
            </form>
          </div>
        </div>

        <!-- Relat√≥rios -->
        <div id="view-reports" class="view hidden">
          <div class="card">
            <h3><i class="fas fa-chart-bar"></i> Relat√≥rios Globais</h3>
            <div class="row">
              <div class="form-group">
                <label for="report-type">Tipo de Relat√≥rio</label>
                <select id="report-type">
                  <option value="condominios">Condom√≠nios</option>
                  <option value="usuarios_globais">Usu√°rios Globais</option>
                  <option value="estatisticas_gerais">Estat√≠sticas Gerais</option>
                  <option value="financeiro">Relat√≥rio Financeiro</option>
                </select>
              </div>
              <div class="form-group">
                <label for="report-start">Data In√≠cio</label>
                <input id="report-start" type="date" />
              </div>
              <div class="form-group">
                <label for="report-end">Data Fim</label>
                <input id="report-end" type="date" />
              </div>
            </div>
            <button id="btn-generate-report" class="btn-primary">
              <i class="fas fa-file-alt"></i> Gerar Relat√≥rio
            </button>
            <button id="btn-export-report" class="btn-secondary" style="margin-left: 10px;">
              <i class="fas fa-download"></i> Exportar PDF
            </button>
          </div>
          <div id="report-results" class="card hidden">
            <h4><i class="fas fa-file-alt"></i> Resultado do Relat√≥rio</h4>
            <div id="report-content"></div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const API_AUTH = '/api/auth';
      const API_TENANTS = '/api/tenants';
      const API_USERS = '/api/users';

      // Vari√°veis globais
      let tenantsChart = null;
      let statusChart = null;

      function showAlert(message, type = 'info') {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type}`;
        alertDiv.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i> ${message}`;
        
        const container = document.querySelector('.container');
        container.insertBefore(alertDiv, container.firstChild);
        
        setTimeout(() => {
          alertDiv.remove();
        }, 5000);
      }

      function setLoading(button, loading, text = 'Carregando...') {
        if (loading) {
          button.innerHTML = `<div class="loading"></div>${text}`;
          button.disabled = true;
        } else {
          button.innerHTML = button.getAttribute('data-original-text') || text;
          button.disabled = false;
        }
      }

      function authFetch(url, options = {}) {
        const token = localStorage.getItem('token');
        return fetch(url, {
          ...options,
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json',
            ...options.headers
          }
        });
      }

      function hideAll() {
        document.querySelectorAll('.view').forEach(view => view.classList.add('hidden'));
      }

      function navigateTo(view) {
        hideAll();
        document.getElementById(`view-${view}`).classList.remove('hidden');
        
        if (view === 'dashboard') loadDashboard();
        if (view === 'tenants') loadTenants();
        if (view === 'users') {
          loadUsers();
          loadTenantsForUsers();
        }
        if (view === 'reports') loadReports();
      }

      async function login() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        if (!email || !password) {
          showAlert('Por favor, preencha todos os campos', 'error');
          return;
        }

        const btn = document.getElementById('btn-login');
        setLoading(btn, true);
        
        try {
          const res = await fetch(API_AUTH + '/super-admin-login', {
            method: 'POST', 
            headers: {'content-type': 'application/json'}, 
            body: JSON.stringify({email, password})
          });
          const data = await res.json();
          
          if (!res.ok) { 
            showAlert(data.detail || 'Erro no login', 'error');
            return; 
          }
          
          localStorage.setItem('token', data.access_token);
          localStorage.setItem('role', data.user.role);
          localStorage.setItem('user', JSON.stringify(data.user));
          localStorage.setItem('is_super_admin', 'true');
          
          document.getElementById('login').classList.add('hidden');
          document.getElementById('dashboard').classList.remove('hidden');
          showAlert('Login realizado com sucesso!', 'success');
          
          // Carregar dashboard inicial
          loadDashboard();
        } catch (error) {
          showAlert('Erro de conex√£o. Tente novamente.', 'error');
        } finally {
          setLoading(btn, false);
        }
      }

      async function loadDashboard() {
        try {
          const [tenantsRes, usersRes] = await Promise.all([
            authFetch(API_TENANTS + '/').catch(() => ({ok: false})),
            authFetch(API_USERS + '/users').catch(() => ({ok: false}))
          ]);

          const tenants = tenantsRes.ok ? await tenantsRes.json() : [];
          const users = usersRes.ok ? await usersRes.json() : [];

          // Atualizar estat√≠sticas
          document.getElementById('total-tenants').textContent = tenants.length;
          document.getElementById('active-tenants').textContent = tenants.filter(t => t.is_active).length;
          document.getElementById('total-users').textContent = users.length;
          document.getElementById('total-reservations').textContent = '0'; // Placeholder

          // Criar gr√°ficos
          createTenantsChart(tenants);
          createStatusChart(tenants);
        } catch (error) {
          console.error('Erro ao carregar dashboard:', error);
        }
      }

      function createTenantsChart(tenants) {
        const ctx = document.getElementById('tenantsChart');
        if (!ctx) return;

        if (tenantsChart) tenantsChart.destroy();

        // Processar dados por m√™s
        const monthlyData = {};
        const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
        
        tenants.forEach(tenant => {
          const date = new Date(tenant.created_at);
          const monthKey = months[date.getMonth()];
          monthlyData[monthKey] = (monthlyData[monthKey] || 0) + 1;
        });

        const data = months.map(month => monthlyData[month] || 0);

        tenantsChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: months,
            datasets: [{
              label: 'Condom√≠nios',
              data: data,
              borderColor: '#9c27b0',
              backgroundColor: 'rgba(156, 39, 176, 0.1)',
              borderWidth: 3,
              tension: 0.4,
              fill: true,
              pointBackgroundColor: '#9c27b0',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 5,
              pointHoverRadius: 7
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
              legend: {
                labels: { color: '#4a148c', font: { size: 12, weight: '600' } }
              }
            },
            scales: {
              y: { beginAtZero: true, ticks: { color: '#666' }, grid: { color: 'rgba(0,0,0,0.05)' } },
              x: { ticks: { color: '#666' }, grid: { display: false } }
            }
          }
        });
      }

      function createStatusChart(tenants) {
        const ctx = document.getElementById('statusChart');
        if (!ctx) return;

        if (statusChart) statusChart.destroy();

        const active = tenants.filter(t => t.is_active).length;
        const inactive = tenants.filter(t => !t.is_active).length;

        statusChart = new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['Ativos', 'Inativos'],
            datasets: [{
              data: [active, inactive],
              backgroundColor: ['#4facfe', '#f5576c'],
              borderWidth: 0,
              hoverOffset: 10
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
              legend: {
                position: 'bottom',
                labels: { color: '#4a148c', font: { size: 12, weight: '600' }, padding: 15 }
              }
            }
          }
        });
      }

      async function loadTenants() {
        try {
          const res = await authFetch(API_TENANTS + '/');
          if (!res.ok) {
            showAlert('Erro ao carregar condom√≠nios', 'error');
            return;
          }
          
          const tenants = await res.json();
          const tbody = document.querySelector('#tbl-tenants tbody');
          tbody.innerHTML = '';
          
          tenants.forEach(tenant => {
            tbody.insertAdjacentHTML('beforeend', `
              <tr>
                <td>${tenant.id}</td>
                <td>${tenant.name}</td>
                <td>${tenant.cnpj}</td>
                <td>${tenant.email}</td>
                <td><span class="status-badge ${tenant.is_active ? 'status-confirmed' : 'status-cancelled'}">${tenant.is_active ? 'Ativo' : 'Inativo'}</span></td>
                <td>${new Date(tenant.created_at).toLocaleDateString()}</td>
                <td>
                  <button onclick="toggleTenantStatus(${tenant.id}, ${tenant.is_active})" class="btn-secondary btn-sm">
                    ${tenant.is_active ? 'Desativar' : 'Ativar'}
                  </button>
                </td>
              </tr>
            `);
          });
        } catch (error) {
          showAlert('Erro de conex√£o', 'error');
        }
      }

      async function loadUsers() {
        try {
          const res = await authFetch(API_USERS + '/users');
          if (!res.ok) {
            showAlert('Erro ao carregar usu√°rios', 'error');
            return;
          }
          
          const users = await res.json();
          const tbody = document.querySelector('#tbl-users tbody');
          tbody.innerHTML = '';
          
          users.forEach(user => {
            tbody.insertAdjacentHTML('beforeend', `
              <tr>
                <td>${user.id}</td>
                <td>${user.full_name || 'N/A'}</td>
                <td>${user.email}</td>
                <td>${user.tenant_id || 'Super Admin'}</td>
                <td>${user.role}</td>
                <td><span class="status-badge ${user.is_active ? 'status-confirmed' : 'status-cancelled'}">${user.is_active ? 'Ativo' : 'Inativo'}</span></td>
                <td>
                  <button onclick="editUser(${user.id})" class="btn-primary btn-sm">Editar</button>
                  <button onclick="deleteUser(${user.id})" class="btn-secondary btn-sm" style="margin-left: 5px;">Excluir</button>
                </td>
              </tr>
            `);
          });
        } catch (error) {
          showAlert('Erro de conex√£o', 'error');
        }
      }

      async function loadTenantsForUsers() {
        try {
          const res = await authFetch(API_TENANTS + '/');
          if (!res.ok) return;
          
          const tenants = await res.json();
          const select = document.getElementById('new-user-tenant');
          const filterSelect = document.getElementById('filter-tenant');
          
          // Limpar op√ß√µes existentes
          select.innerHTML = '<option value="">Selecione um condom√≠nio</option>';
          filterSelect.innerHTML = '<option value="">Todos os condom√≠nios</option>';
          
          tenants.forEach(tenant => {
            const option = document.createElement('option');
            option.value = tenant.id;
            option.textContent = tenant.name;
            select.appendChild(option);
            
            const filterOption = document.createElement('option');
            filterOption.value = tenant.id;
            filterOption.textContent = tenant.name;
            filterSelect.appendChild(filterOption);
          });
        } catch (error) {
          console.error('Erro ao carregar condom√≠nios:', error);
        }
      }

      async function loadReports() {
        // Set default dates
        const today = new Date();
        const lastMonth = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
        
        document.getElementById('report-start').value = lastMonth.toISOString().split('T')[0];
        document.getElementById('report-end').value = today.toISOString().split('T')[0];
      }

      // Fun√ß√µes globais
      window.toggleTenantStatus = async function(tenantId, currentStatus) {
        try {
          const res = await authFetch(`${API_TENANTS}/${tenantId}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ is_active: !currentStatus })
          });
          
          if (res.ok) {
            showAlert(`Condom√≠nio ${!currentStatus ? 'ativado' : 'desativado'} com sucesso!`, 'success');
            loadTenants();
            loadDashboard(); // Atualizar dashboard
          } else {
            showAlert('Erro ao alterar status do condom√≠nio', 'error');
          }
        } catch (error) {
          showAlert('Erro de conex√£o', 'error');
        }
      };

      window.editUser = function(userId) {
        showAlert('Funcionalidade de edi√ß√£o ser√° implementada em breve', 'info');
      };

      window.deleteUser = async function(userId) {
        if (!confirm('Tem certeza que deseja excluir este usu√°rio?')) return;
        
        try {
          const res = await authFetch(`${API_USERS}/users/${userId}`, {
            method: 'DELETE'
          });
          
          if (res.ok) {
            showAlert('Usu√°rio exclu√≠do com sucesso!', 'success');
            loadUsers();
            loadDashboard(); // Atualizar dashboard
          } else {
            showAlert('Erro ao excluir usu√°rio', 'error');
          }
        } catch (error) {
          showAlert('Erro de conex√£o', 'error');
        }
      };

      // Event listeners
      document.getElementById('btn-login').onclick = login;
      
      // Navega√ß√£o
      document.querySelectorAll('[data-view]').forEach(link => {
        link.onclick = (e) => {
          e.preventDefault();
          navigateTo(link.dataset.view);
        };
      });

      // Logout
      document.getElementById('logout').onclick = () => {
        localStorage.clear();
        location.reload();
      };

      // Formul√°rio de condom√≠nio
      document.getElementById('tenant-form').onsubmit = async (e) => {
        e.preventDefault();
        
        const formData = {
          name: document.getElementById('new-tenant-name').value,
          cnpj: document.getElementById('new-tenant-cnpj').value,
          address: document.getElementById('new-tenant-address').value,
          phone: document.getElementById('new-tenant-phone').value,
          email: document.getElementById('new-tenant-email').value,
          theme_config: {
            primary_color: document.getElementById('new-theme-primary').value,
            secondary_color: document.getElementById('new-theme-secondary').value
          },
          admin_name: document.getElementById('new-admin-name').value,
          admin_email: document.getElementById('new-admin-email').value,
          admin_password: document.getElementById('new-admin-password').value
        };

        try {
          const res = await authFetch(API_TENANTS + '/', {
            method: 'POST',
            body: JSON.stringify(formData)
          });

          if (res.ok) {
            showAlert('Condom√≠nio cadastrado com sucesso!', 'success');
            document.getElementById('tenant-form').reset();
            loadTenants();
            loadDashboard();
          } else {
            const error = await res.json();
            showAlert('Erro: ' + (error.detail || 'Erro desconhecido'), 'error');
          }
        } catch (error) {
          showAlert('Erro de conex√£o', 'error');
        }
      };

      // Formul√°rio de usu√°rio
      document.getElementById('user-form').onsubmit = async (e) => {
        e.preventDefault();
        
        // Coletar permiss√µes selecionadas
        const selectedPermissions = Array.from(document.querySelectorAll('input[name="permissions"]:checked'))
          .map(checkbox => checkbox.value);
        
        // Coletar telas selecionadas
        const selectedScreens = Array.from(document.querySelectorAll('input[name="screen_permissions"]:checked'))
          .map(checkbox => checkbox.value);
        
        const formData = {
          full_name: document.getElementById('new-user-name').value,
          email: document.getElementById('new-user-email').value,
          password: document.getElementById('new-user-password').value,
          tenant_id: parseInt(document.getElementById('new-user-tenant').value),
          role: document.getElementById('new-user-role').value,
          is_active: document.getElementById('new-user-status').value === 'true',
          permissions: selectedPermissions,
          screen_permissions: selectedScreens,
          phone: document.getElementById('new-user-phone').value || null,
          document: document.getElementById('new-user-document').value || null
        };

        const btn = document.querySelector('#user-form button[type="submit"]');
        setLoading(btn, true, 'Criando usu√°rio...');

        try {
          const res = await authFetch(API_USERS + '/users', {
            method: 'POST',
            body: JSON.stringify(formData)
          });

          if (res.ok) {
            showAlert('Usu√°rio criado com sucesso!', 'success');
            document.getElementById('user-form').reset();
            loadUsers();
            loadDashboard();
          } else {
            const error = await res.json();
            showAlert('Erro: ' + (error.detail || 'Erro desconhecido'), 'error');
          }
        } catch (error) {
          showAlert('Erro de conex√£o', 'error');
        } finally {
          setLoading(btn, false);
        }
      };

      // Templates de fun√ß√£o
      window.applyRoleTemplate = function(role) {
        // Limpar todas as sele√ß√µes
        document.querySelectorAll('input[name="permissions"]').forEach(cb => cb.checked = false);
        document.querySelectorAll('input[name="screen_permissions"]').forEach(cb => cb.checked = false);
        
        // Atualizar fun√ß√£o
        document.getElementById('new-user-role').value = role;
        
        // Aplicar templates baseados na fun√ß√£o
        switch(role) {
          case 'admin':
            // Administrador completo - todas as permiss√µes
            document.querySelectorAll('input[name="permissions"]').forEach(cb => cb.checked = true);
            document.querySelectorAll('input[name="screen_permissions"]').forEach(cb => cb.checked = true);
            break;
            
          case 'sindico':
            // S√≠ndico - gest√£o completa exceto usu√°rios
            document.querySelectorAll('input[name="screen_permissions"]').forEach(cb => {
              if (['dashboard', 'family', 'visitors', 'units', 'maintenance', 'reservations', 'reports'].includes(cb.value)) {
                cb.checked = true;
              }
            });
            document.querySelectorAll('input[name="permissions"]').forEach(cb => {
              if (['manage_units', 'create_units', 'manage_reservations', 'create_reservations', 'manage_visitors', 'register_visitors', 'manage_maintenance', 'create_maintenance', 'view_reports', 'export_reports'].includes(cb.value)) {
                cb.checked = true;
              }
            });
            break;
            
          case 'morador':
            // Morador - apenas visualiza√ß√£o e a√ß√µes b√°sicas
            document.querySelectorAll('input[name="screen_permissions"]').forEach(cb => {
              if (['dashboard', 'family', 'visitors', 'reservations'].includes(cb.value)) {
                cb.checked = true;
              }
            });
            document.querySelectorAll('input[name="permissions"]').forEach(cb => {
              if (['create_reservations', 'register_visitors', 'create_maintenance'].includes(cb.value)) {
                cb.checked = true;
              }
            });
            break;
            
          case 'porteiro':
            // Porteiro - foco em visitantes e entrada
            document.querySelectorAll('input[name="screen_permissions"]').forEach(cb => {
              if (['dashboard', 'visitors'].includes(cb.value)) {
                cb.checked = true;
              }
            });
            document.querySelectorAll('input[name="permissions"]').forEach(cb => {
              if (['manage_visitors', 'register_visitors'].includes(cb.value)) {
                cb.checked = true;
              }
            });
            break;
            
          case 'custom':
            // Personalizado - apenas dashboard
            document.querySelector('input[name="screen_permissions"][value="dashboard"]').checked = true;
            break;
        }
        
        showAlert(`Template "${role}" aplicado com sucesso!`, 'success');
      };

      // Relat√≥rios
      document.getElementById('btn-generate-report').onclick = async () => {
        const reportType = document.getElementById('report-type').value;
        const startDate = document.getElementById('report-start').value;
        const endDate = document.getElementById('report-end').value;
        
        if (!startDate || !endDate) {
          showAlert('Por favor, selecione as datas', 'error');
          return;
        }

        showAlert('Relat√≥rio gerado com sucesso!', 'success');
        document.getElementById('report-results').classList.remove('hidden');
        document.getElementById('report-content').innerHTML = `
          <div class="alert alert-info">
            <h4>Relat√≥rio: ${reportType}</h4>
            <p><strong>Per√≠odo:</strong> ${startDate} a ${endDate}</p>
            <p>Relat√≥rio gerado em: ${new Date().toLocaleString()}</p>
          </div>
        `;
      };

      // Refresh buttons
      document.getElementById('refresh-tenants').onclick = loadTenants;

      // Busca e filtro de usu√°rios
      document.getElementById('search-user').oninput = (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const rows = document.querySelectorAll('#tbl-users tbody tr');
        
        rows.forEach(row => {
          const name = row.cells[1].textContent.toLowerCase();
          const email = row.cells[2].textContent.toLowerCase();
          
          if (name.includes(searchTerm) || email.includes(searchTerm)) {
            row.style.display = '';
          } else {
            row.style.display = 'none';
          }
        });
      };

      document.getElementById('filter-tenant').onchange = (e) => {
        const selectedTenant = e.target.value;
        const rows = document.querySelectorAll('#tbl-users tbody tr');
        
        rows.forEach(row => {
          const tenantId = row.cells[3].textContent;
          
          if (!selectedTenant || tenantId.includes(selectedTenant)) {
            row.style.display = '';
          } else {
            row.style.display = 'none';
          }
        });
      };

      // Store original button texts
      document.querySelectorAll('button').forEach(btn => {
        btn.setAttribute('data-original-text', btn.innerHTML);
      });
    </script>
  </body>
</html>
